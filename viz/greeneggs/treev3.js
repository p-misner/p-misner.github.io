var treeData =
  {
  "children": [
    {
      "children": [
        {
          "children": [
            {
              "name": "Sam",
              "value": 1
            }
          ],
          "name": "am",
          "value": 1
        },
        {
          "children": [
            {
              "children": [
                {
                  "children": [
                    {
                      "children": [
                        {
                          "name": "Sam-I-am",
                          "value": 1
                        }
                      ],
                      "name": "that",
                      "value": 1
                    },
                    {
                      "children": [
                        {
                          "name": "Sam-I-am",
                          "value": 1
                        }
                      ],
                      "name": "them",
                      "value": 1
                    },
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "ham",
                                  "value": 1
                                }
                              ],
                              "name": "and",
                              "value": 1
                            }
                          ],
                          "name": "eggs",
                          "value": 1
                        }
                      ],
                      "name": "green",
                      "value": 1
                    }
                  ],
                  "name": "like",
                  "value": 3
                }
              ],
              "name": "not",
              "value": 3
            }
          ],
          "name": "do",
          "value": 24
        },
        {
          "children": [
            {
              "children": [
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "there",
                                  "value": 2
                                }
                              ],
                              "name": "or",
                              "value": 2
                            }
                          ],
                          "name": "here",
                          "value": 2
                        },
                        {
                          "name": "anywhere",
                          "value": 7
                        },
                        {
                          "name": "Sam-I-am",
                          "value": 2
                        },
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "house",
                                  "value": 1
                                }
                              ],
                              "name": "a",
                              "value": 1
                            }
                          ],
                          "name": "in",
                          "value": 1
                        },
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "mouse",
                                  "value": 1
                                }
                              ],
                              "name": "a",
                              "value": 1
                            }
                          ],
                          "name": "with",
                          "value": 1
                        }
                      ],
                      "name": "them",
                      "value": 8
                    },
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "ham",
                                  "value": 2
                                }
                              ],
                              "name": "and",
                              "value": 2
                            }
                          ],
                          "name": "eggs",
                          "value": 2
                        }
                      ],
                      "name": "green",
                      "value": 2
                    }
                  ],
                  "name": "like",
                  "value": 19
                },
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "there",
                                  "value": 2
                                }
                              ],
                              "name": "or",
                              "value": 2
                            }
                          ],
                          "name": "here",
                          "value": 2
                        },
                        {
                          "name": "Sam-I-am",
                          "value": 2
                        },
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "box",
                                  "value": 1
                                }
                              ],
                              "name": "a",
                              "value": 1
                            }
                          ],
                          "name": "in",
                          "value": 3
                        },
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "fox",
                                  "value": 1
                                },
                                {
                                  "name": "house",
                                  "value": 1
                                },
                                {
                                  "name": "mouse",
                                  "value": 1
                                },
                                {
                                  "name": "box",
                                  "value": 1
                                }
                              ],
                              "name": "a",
                              "value": 4
                            }
                          ],
                          "name": "with",
                          "value": 2
                        }
                      ],
                      "name": "them",
                      "value": 10
                    },
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "ham",
                                  "value": 2
                                }
                              ],
                              "name": "and",
                              "value": 2
                            }
                          ],
                          "name": "eggs",
                          "value": 2
                        }
                      ],
                      "name": "green",
                      "value": 2
                    }
                  ],
                  "name": "eat",
                  "value": 3
                },
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "car",
                                  "value": 1
                                },
                                {
                                  "name": "tree",
                                  "value": 1
                                }
                              ],
                              "name": "a",
                              "value": 2
                            }
                          ],
                          "name": "in",
                          "value": 2
                        }
                      ],
                      "name": "not",
                      "value": 3
                    }
                  ],
                  "name": "could",
                  "value": 3
                }
              ],
              "name": "not",
              "value": 25
            }
          ],
          "name": "would",
          "value": 11
        },
        {
          "children": [
            {
              "children": [
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "fox",
                                  "value": 1
                                }
                              ],
                              "name": "a",
                              "value": 1
                            }
                          ],
                          "name": "with",
                          "value": 1
                        }
                      ],
                      "name": "not",
                      "value": 1
                    }
                  ],
                  "name": "would",
                  "value": 1
                }
              ],
              "name": "not",
              "value": 1
            }
          ],
          "name": "could",
          "value": 2
        },
        {
          "children": [
            {
              "children": [
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "mouse",
                                  "value": 1
                                }
                              ],
                              "name": "a",
                              "value": 1
                            }
                          ],
                          "name": "with",
                          "value": 1
                        },
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "house",
                                  "value": 1
                                }
                              ],
                              "name": "a",
                              "value": 1
                            }
                          ],
                          "name": "in",
                          "value": 1
                        },
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "there",
                                  "value": 1
                                }
                              ],
                              "name": "or",
                              "value": 1
                            }
                          ],
                          "name": "here",
                          "value": 1
                        }
                      ],
                      "name": "them",
                      "value": 4
                    }
                  ],
                  "name": "eat",
                  "value": 8
                },
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "spam",
                                  "value": 1
                                }
                              ],
                              "name": "and",
                              "value": 1
                            }
                          ],
                          "name": "eggs",
                          "value": 1
                        }
                      ],
                      "name": "green",
                      "value": 1
                    },
                    {
                      "children": [
                        {
                          "name": "Sam-I-am",
                          "value": 1
                        },
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "see",
                                  "value": 1
                                }
                              ],
                              "name": "you",
                              "value": 1
                            }
                          ],
                          "name": "Sam",
                          "value": 1
                        },
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "there",
                                  "value": 1
                                }
                              ],
                              "name": "or",
                              "value": 1
                            }
                          ],
                          "name": "here",
                          "value": 1
                        }
                      ],
                      "name": "them",
                      "value": 4
                    }
                  ],
                  "name": "like",
                  "value": 4
                },
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "dark",
                                  "value": 1
                                },
                                {
                                  "name": "rain",
                                  "value": 1
                                }
                              ],
                              "name": "the",
                              "value": 2
                            }
                          ],
                          "name": "in",
                          "value": 2
                        }
                      ],
                      "name": "not",
                      "value": 2
                    }
                  ],
                  "name": "could",
                  "value": 2
                }
              ],
              "name": "not",
              "value": 11
            }
          ],
          "name": "will",
          "value": 11
        },
        {
          "children": [
            {
              "children": [
                {
                  "children": [
                    {
                      "children": [
                        {
                          "name": "ham",
                          "value": 1
                        }
                      ],
                      "name": "and",
                      "value": 1
                    }
                  ],
                  "name": "eggs",
                  "value": 1
                }
              ],
              "name": "green",
              "value": 1
            },
            {
              "children": [
                {
                  "name": "Sam-I-am",
                  "value": 1
                }
              ],
              "name": "them",
              "value": 1
            }
          ],
          "name": "like",
          "value": 2
        }
      ],
      "name": "I",
      "value": 60
    },
    {
      "children": [
        {
          "children": [
            {
              "name": "am",
              "value": 1
            }
          ],
          "name": "I",
          "value": 1
        }
      ],
      "name": "Sam",
      "value": 3
    },
    {
      "children": [
        {
          "name": "Sam-I-am",
          "value": 2
        }
      ],
      "name": "That",
      "value": 2
    },
    {
      "children": [
        {
          "children": [
            {
              "children": [
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "name": "ham",
                              "value": 1
                            }
                          ],
                          "name": "and",
                          "value": 1
                        }
                      ],
                      "name": "eggs",
                      "value": 1
                    }
                  ],
                  "name": "green",
                  "value": 1
                }
              ],
              "name": "like",
              "value": 1
            }
          ],
          "name": "you",
          "value": 1
        }
      ],
      "name": "Do",
      "value": 1
    },
    {
      "children": [
        {
          "children": [
            {
              "children": [
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "name": "there",
                              "value": 1
                            }
                          ],
                          "name": "or",
                          "value": 1
                        }
                      ],
                      "name": "here",
                      "value": 1
                    },
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "name": "house",
                              "value": 1
                            }
                          ],
                          "name": "a",
                          "value": 1
                        }
                      ],
                      "name": "in",
                      "value": 1
                    },
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "name": "mouse",
                              "value": 1
                            }
                          ],
                          "name": "a",
                          "value": 1
                        }
                      ],
                      "name": "with",
                      "value": 1
                    }
                  ],
                  "name": "them",
                  "value": 3
                }
              ],
              "name": "like",
              "value": 3
            },
            {
              "children": [
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "name": "box",
                              "value": 1
                            }
                          ],
                          "name": "a",
                          "value": 1
                        }
                      ],
                      "name": "in",
                      "value": 1
                    },
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "name": "fox",
                              "value": 1
                            }
                          ],
                          "name": "a",
                          "value": 1
                        }
                      ],
                      "name": "with",
                      "value": 1
                    }
                  ],
                  "name": "them",
                  "value": 2
                }
              ],
              "name": "eat",
              "value": 3
            }
          ],
          "name": "you",
          "value": 6
        }
      ],
      "name": "Would",
      "value": 9
    },
    {
      "children": [
        {
          "children": [
            {
              "children": [
                {
                  "name": "box",
                  "value": 1
                }
              ],
              "name": "a",
              "value": 1
            }
          ],
          "name": "in",
          "value": 6
        },
        {
          "children": [
            {
              "children": [
                {
                  "name": "fox",
                  "value": 1
                },
                {
                  "name": "house",
                  "value": 1
                },
                {
                  "name": "mouse",
                  "value": 1
                },
                {
                  "name": "car",
                  "value": 5
                },
                {
                  "name": "train",
                  "value": 3
                },
                {
                  "name": "tree",
                  "value": 1
                }
              ],
              "name": "a",
              "value": 7
            }
          ],
          "name": "with",
          "value": 4
        },
        {
          "children": [
            {
              "name": "a",
              "value": 1
            }
          ],
          "name": "on",
          "value": 1
        }
      ],
      "name": "Not",
      "value": 19
    },
    {
      "children": [
        {
          "children": [
            {
              "children": [
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "name": "train",
                              "value": 1
                            }
                          ],
                          "name": "a",
                          "value": 1
                        }
                      ],
                      "name": "on",
                      "value": 1
                    }
                  ],
                  "name": "you",
                  "value": 1
                }
              ],
              "name": "would",
              "value": 2
            },
            {
              "children": [
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "name": "dark",
                              "value": 1
                            },
                            {
                              "name": "rain",
                              "value": 1
                            }
                          ],
                          "name": "the",
                          "value": 2
                        }
                      ],
                      "name": "in",
                      "value": 2
                    },
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "name": "goat",
                              "value": 1
                            }
                          ],
                          "name": "a",
                          "value": 1
                        }
                      ],
                      "name": "with",
                      "value": 1
                    },
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "name": "boat",
                              "value": 1
                            }
                          ],
                          "name": "a",
                          "value": 1
                        }
                      ],
                      "name": "on",
                      "value": 1
                    }
                  ],
                  "name": "you",
                  "value": 4
                }
              ],
              "name": "could",
              "value": 3
            }
          ],
          "name": "you",
          "value": 6
        }
      ],
      "name": "Could",
      "value": 3
    },
    {
      "children": [
        {
          "children": [
            {
              "name": "car",
              "value": 1
            }
          ],
          "name": "a",
          "value": 1
        },
        {
          "children": [
            {
              "name": "dark",
              "value": 1
            }
          ],
          "name": "the",
          "value": 1
        }
      ],
      "name": "In",
      "value": 2
    },
    {
      "children": [
        {
          "name": "them",
          "value": 2
        }
      ],
      "name": "Eat",
      "value": 2
    },
    {
      "children": [
        {
          "children": [
            {
              "name": "are",
              "value": 1
            }
          ],
          "name": "they",
          "value": 1
        },
        {
          "children": [
            {
              "children": [
                {
                  "name": "dark",
                  "value": 4
                }
              ],
              "name": "the",
              "value": 4
            },
            {
              "children": [
                {
                  "name": "tree",
                  "value": 2
                },
                {
                  "name": "house",
                  "value": 1
                },
                {
                  "name": "box",
                  "value": 1
                },
                {
                  "name": "mouse",
                  "value": 1
                },
                {
                  "name": "fox",
                  "value": 1
                }
              ],
              "name": "a",
              "value": 8
            }
          ],
          "name": "in",
          "value": 12
        }
      ],
      "name": "Here",
      "value": 2
    },
    {
      "children": [
        {
          "children": [
            {
              "children": [
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "name": "tree",
                              "value": 1
                            }
                          ],
                          "name": "a",
                          "value": 1
                        }
                      ],
                      "name": "in",
                      "value": 1
                    },
                    {
                      "name": "anywhere",
                      "value": 1
                    }
                  ],
                  "name": "them",
                  "value": 3
                }
              ],
              "name": "like",
              "value": 2
            }
          ],
          "name": "may",
          "value": 2
        },
        {
          "children": [
            {
              "name": "see",
              "value": 2
            }
          ],
          "name": "will",
          "value": 1
        },
        {
          "children": [
            {
              "children": [
                {
                  "name": "be",
                  "value": 2
                }
              ],
              "name": "me",
              "value": 2
            }
          ],
          "name": "let",
          "value": 2
        },
        {
          "children": [
            {
              "children": [
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "ham",
                                  "value": 2
                                }
                              ],
                              "name": "and",
                              "value": 2
                            }
                          ],
                          "name": "eggs",
                          "value": 2
                        }
                      ],
                      "name": "green",
                      "value": 2
                    },
                    {
                      "children": [
                        {
                          "name": "Sam-I-am",
                          "value": 2
                        },
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "rain",
                                  "value": 1
                                }
                              ],
                              "name": "the",
                              "value": 1
                            },
                            {
                              "children": [
                                {
                                  "name": "box",
                                  "value": 1
                                }
                              ],
                              "name": "a",
                              "value": 1
                            }
                          ],
                          "name": "in",
                          "value": 3
                        },
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "train",
                                  "value": 1
                                }
                              ],
                              "name": "a",
                              "value": 1
                            }
                          ],
                          "name": "on",
                          "value": 1
                        },
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "fox",
                                  "value": 1
                                },
                                {
                                  "name": "house",
                                  "value": 1
                                },
                                {
                                  "name": "mouse",
                                  "value": 1
                                }
                              ],
                              "name": "a",
                              "value": 3
                            }
                          ],
                          "name": "with",
                          "value": 2
                        },
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "there",
                                  "value": 1
                                }
                              ],
                              "name": "or",
                              "value": 1
                            }
                          ],
                          "name": "here",
                          "value": 1
                        }
                      ],
                      "name": "them",
                      "value": 11
                    }
                  ],
                  "name": "like",
                  "value": 10
                },
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "goat",
                                  "value": 3
                                }
                              ],
                              "name": "a",
                              "value": 1
                            }
                          ],
                          "name": "with",
                          "value": 1
                        }
                      ],
                      "name": "not",
                      "value": 1
                    }
                  ],
                  "name": "could",
                  "value": 1
                },
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "boat",
                                  "value": 2
                                }
                              ],
                              "name": "a",
                              "value": 1
                            }
                          ],
                          "name": "on",
                          "value": 1
                        }
                      ],
                      "name": "not",
                      "value": 1
                    }
                  ],
                  "name": "would",
                  "value": 1
                },
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "name": "a",
                              "value": 1
                            }
                          ],
                          "name": "with",
                          "value": 1
                        }
                      ],
                      "name": "not",
                      "value": 1
                    }
                  ],
                  "name": "will",
                  "value": 1
                }
              ],
              "name": "not",
              "value": 16
            },
            {
              "children": [
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "ham",
                                  "value": 1
                                }
                              ],
                              "name": "and",
                              "value": 1
                            }
                          ],
                          "name": "eggs",
                          "value": 1
                        }
                      ],
                      "name": "green",
                      "value": 1
                    }
                  ],
                  "name": "like",
                  "value": 1
                }
              ],
              "name": "so",
              "value": 1
            }
          ],
          "name": "do",
          "value": 12
        }
      ],
      "name": "You",
      "value": 8
    },
    {
      "children": [
        {
          "name": "train",
          "value": 4
        }
      ],
      "name": "A",
      "value": 4
    },
    {
      "children": [
        {
          "children": [
            {
              "name": "be",
              "value": 1
            }
          ],
          "name": "me",
          "value": 1
        }
      ],
      "name": "Let",
      "value": 1
    },
    {
      "name": "Say",
      "value": 3
    },
    {
      "children": [
        {
          "children": [
            {
              "name": "say",
              "value": 1
            }
          ],
          "name": "you",
          "value": 1
        },
        {
          "children": [
            {
              "children": [
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "box",
                                  "value": 1
                                }
                              ],
                              "name": "a",
                              "value": 1
                            }
                          ],
                          "name": "in",
                          "value": 2
                        },
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "fox",
                                  "value": 1
                                },
                                {
                                  "name": "house",
                                  "value": 1
                                },
                                {
                                  "name": "mouse",
                                  "value": 1
                                }
                              ],
                              "name": "a",
                              "value": 3
                            }
                          ],
                          "name": "with",
                          "value": 2
                        },
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "there",
                                  "value": 1
                                }
                              ],
                              "name": "and",
                              "value": 1
                            }
                          ],
                          "name": "here",
                          "value": 1
                        }
                      ],
                      "name": "them",
                      "value": 5
                    }
                  ],
                  "name": "eat",
                  "value": 5
                }
              ],
              "name": "will",
              "value": 5
            }
          ],
          "name": "I",
          "value": 5
        }
      ],
      "name": "So",
      "value": 2
    },
    {
      "children": [
        {
          "children": [
            {
              "children": [
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "name": "say",
                              "value": 1
                            }
                          ],
                          "name": "I",
                          "value": 1
                        }
                      ],
                      "name": "may",
                      "value": 1
                    }
                  ],
                  "name": "you",
                  "value": 1
                }
              ],
              "name": "and",
              "value": 1
            }
          ],
          "name": "them",
          "value": 3
        }
      ],
      "name": "Try",
      "value": 3
    },
    {
      "children": [
        {
          "children": [
            {
              "name": "may",
              "value": 1
            }
          ],
          "name": "you",
          "value": 1
        },
        {
          "children": [
            {
              "children": [
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "name": "a",
                              "value": 1
                            }
                          ],
                          "name": "in",
                          "value": 1
                        },
                        {
                          "children": [
                            {
                              "name": "a",
                              "value": 1
                            }
                          ],
                          "name": "with",
                          "value": 1
                        }
                      ],
                      "name": "them",
                      "value": 2
                    }
                  ],
                  "name": "eat",
                  "value": 2
                }
              ],
              "name": "would",
              "value": 2
            },
            {
              "children": [
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "rain",
                                  "value": 1
                                }
                              ],
                              "name": "the",
                              "value": 1
                            }
                          ],
                          "name": "in",
                          "value": 1
                        }
                      ],
                      "name": "them",
                      "value": 1
                    }
                  ],
                  "name": "eat",
                  "value": 1
                }
              ],
              "name": "will",
              "value": 1
            }
          ],
          "name": "I",
          "value": 3
        },
        {
          "children": [
            {
              "children": [
                {
                  "name": "tree",
                  "value": 1
                }
              ],
              "name": "a",
              "value": 3
            }
          ],
          "name": "on",
          "value": 1
        }
      ],
      "name": "And",
      "value": 12
    },
    {
      "children": [
        {
          "children": [
            {
              "children": [
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "children": [
                                    {
                                      "children": [
                                        {
                                          "name": "them",
                                          "value": 1
                                        }
                                      ],
                                      "name": "try",
                                      "value": 1
                                    }
                                  ],
                                  "name": "will",
                                  "value": 1
                                }
                              ],
                              "name": "I",
                              "value": 1
                            }
                          ],
                          "name": "be",
                          "value": 1
                        }
                      ],
                      "name": "me",
                      "value": 1
                    }
                  ],
                  "name": "let",
                  "value": 1
                }
              ],
              "name": "will",
              "value": 1
            }
          ],
          "name": "you",
          "value": 1
        }
      ],
      "name": "If",
      "value": 1
    },
    {
      "children": [
        {
          "children": [
            {
              "children": [
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "name": "see",
                                  "value": 1
                                }
                              ],
                              "name": "you",
                              "value": 1
                            }
                          ],
                          "name": "good",
                          "value": 1
                        }
                      ],
                      "name": "so",
                      "value": 1
                    }
                  ],
                  "name": "good",
                  "value": 1
                }
              ],
              "name": "so",
              "value": 1
            }
          ],
          "name": "are",
          "value": 1
        }
      ],
      "name": "They",
      "value": 1
    },
    {
      "children": [
        {
          "children": [
            {
              "name": "Sam-I-am",
              "value": 1
            }
          ],
          "name": "you",
          "value": 2
        }
      ],
      "name": "Thank",
      "value": 2
    }
  ],
  "name": "Green Eggs and Ham",
  "value": 15
};

// Set the dimensions and margins of the diagram
var margin = {top: 30, right: 90, bottom: 40, left: 20},
    width = 1000 - margin.left - margin.right,
    height = 900 - margin.top - margin.bottom;
let radius = height / width >= 1 ?  (width/2 ) : (height/2  );

var attach = d3.select("#radial")
    .attr("class","area")
    .attr("width", width + margin.right + margin.left)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
      .attr("transform", "translate(" + (width / 2 + margin.left) + "," + (height / 2 + margin.top) + ")");

var duration = d3.event && d3.event.altKey ? 250 : 1500;

var i = 0;
var root;
var logScale = d3.scaleLog()
  .domain([1, 70])
  .range([4, 23]);
var myColor = d3.scaleLinear().domain([1,84])
  .range(["#faa278", "#0d851d"])
// declares a tree layout and assigns the size
var tree = d3.tree()
  .size([2*Math.PI, radius])
  .separation((a,b) => (logScale(a.value) > logScale(b.value) ? 1.2*logScale(a.value) : 1.2*logScale(b.value) )/a.depth);

// Assigns parent, children, height, depth
root = d3.hierarchy(treeData, function(d) { return d.children; });
root.x0 = 0;
root.y0=0;

// Collapse after the second level
root.children.forEach(collapse);

update(root);

// Collapse the node and all it's children
function collapse(d) {
  if(d.children) {
    d._children = d.children
    d._children.forEach(collapse)
    d.children = null
    }
  }

function update(source) {

  // Assigns the x and y position for the nodes
  var treeData2 = tree(root);
  
  // Compute the new tree layout.
  var nodes = treeData2.descendants(),
      links = treeData2.descendants().slice(1);

  // Normalize for fixed-depth.
  // nodes.forEach(function(d){ d.y = d.depth * (radius/10)});

  // ****************** Nodes section ***************************

  // Update the nodes...
  var node = attach.selectAll('g.node')
      .data(nodes, function(d) {return d.id || (d.id = ++i); });

  // Enter any new modes at the parent's previous position.
  var nodeEnter = node.enter().append('g')
      .attr('class', 'node')
    //   .attr("transform", function(d) {
    //     return "translate(" + source.y0 + "," + source.x0 + ")";
    // })
    .on('click', click);

  // Add Circle for the nodes
  nodeEnter.append('circle')
      .attr('class', 'node')
      .attr('r', 1e-6)
      .style("fill", d=> {return myColor(d.data.value)})
      .style("opacity", function(d){
        return d._children ? 0.5 : 1;
      });

  // Add labels for the nodes
  nodeEnter.append('text')
      .attr("dy", ".35em")
      .attr("x", function(d) {
        // console.log(d);
          // return d.children || d._children ? 32 : 13;
          return 10 + logScale(d.data.value);
      })
      .attr("text-anchor", function(d) {
          return d.children || d._children ? "start" : "start";
      })

      .text(function(d) { return d.data.name; });
  // UPDATE
  var nodeUpdate = nodeEnter.merge(node);

  // Transition to the proper position for the node
  nodeUpdate.transition()
    .duration(duration)
      .attr("transform", d => `
        rotate(${d.x * 180 / Math.PI - 90})
        translate(${d.y },0)
      `)


  // Update the node attributes and style
  nodeUpdate.select('circle.node')
    .attr('r', d=> logScale(d.value))
    .style("fill", d=> {return myColor(d.data.value)})
   .style("opacity", function(d){
      return d._children ? 0.5 : 1;
    })
    .attr('cursor', 'pointer');


  // Remove any exiting nodes
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) {
          return "translate(" + source.y + "," + source.x + ")";
      })
      .remove();

  // On exit reduce the node circles size to 0
  nodeExit.select('circle')
    .attr('r', 1e-6);

  // On exit reduce the opacity of text labels
  nodeExit.select('text')
    .style('fill-opacity', 1e-6);

  // ****************** links section ***************************

  // Update the links...
  var link = attach.selectAll('path.link')
    .data(links, function(d) { return d.id; });

  // Enter any new links at the parent's previous position.
  var linkEnter = link.enter().insert('path', "g")
      .attr("class", "link")
      .attr('d', function(d){
        var o = {x: d.x, y: d.y, x0: d.parent.x, y0: d.parent.y };
        // return d3.linkRadial().angle(d =>  d.x).radius(d => d.y)
        return diagonal(o);
      });

  // update positions
  var linkUpdate = linkEnter.merge(link);

  // Transition back to the parent element position
  linkUpdate.transition()
      .duration(duration)
      .attr('d', function(d){ 
        var o = {x: d.x, y: d.y, x0: d.parent.x, y0: d.parent.y };
        return diagonal(o);
      });

  // Remove any exiting links
  var linkExit = link.exit().transition()
      .duration(duration/2)
      .attr('d', function(d) {
        var o = {x: d.x, y: d.y, x0: d.parent.x, y0: d.parent.y };
        return diagonal(o);

      })
      .remove();

  // Store the old positions for transition.
  nodes.forEach(function(d){
    d.x0 = d.x;
    d.y0 = d.y;
  });


  // Toggle children on click.
  function click(d) {
    console.log("click");
    if (d.children) {
        d._children = d.children;
        d.children = null;
      } else {
        d.children = d._children;
        d._children = null;
      }
    update(d);
  }

  //calculate svg path
  
}
function diagonal(s) {
      // x radius; y angle
      path = `M ${s.y} ${s.x} ${s.y0} ${s.x0}`;
      let deg = 270;
      path2 = `M ${s.y*Math.cos(s.x +d2r(deg))} ${s.y*Math.sin(s.x +d2r(deg))} ${(s.y0)*Math.cos(s.x0 +d2r(deg))} ${(s.y0)*Math.sin(s.x0+d2r(deg))}`;
      // console.log(path2);
      return path2;
  }

  //degree to radian converter
  function d2r(degrees) {
    var pi = Math.PI;
    return degrees*pi/180;
  }
function expandAll(){
    expand(root); 
    update(root);
}
function expand(d){   
    var children = (d.children)?d.children:d._children;
    if (d._children) {        
        d.children = d._children;
        d._children = null;       
    }
    if(children)
      children.forEach(expand);
}
function collapseAll(){
    root.children.forEach(collapse);
    collapse(root);
    update(root);
}




/****




**////
